<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Caryn Geady" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Usage - RECIST vs Reality</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Usage";
        var mkdocs_page_input_path = "usage.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> RECIST vs Reality
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Usage</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#project-configuration">Project Configuration</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#data-setup">Data Setup</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#raw-data">Raw Data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#processed-data">Processed Data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#results">Results</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#running-your-analysis">Running Your Analysis</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1-running-med-imagetools">1. Running Med-ImageTools</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../data_sources/">Data Sources</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Developer Notes</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../devnotes/devnotes_caryn/">Caryn</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../devnotes/devnotes_katy/">Katy</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">RECIST vs Reality</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Usage</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/bhklab/recist-vs-reality/edit/master/docs/usage.md">Edit on recist-vs-reality</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="usage-guide">Usage Guide</h1>
<h2 id="project-configuration">Project Configuration</h2>
<p>Each dataset needs a configuration file with the following settings filled in</p>
<pre><code>DATA_SOURCE: &quot;&quot;    # where the data came from, will be used for data organization
DATASET_NAME: &quot;&quot;   # the name of the dataset , will be use for data organization

### MED-IMAGETOOLS settings
MIT:
    MODALITIES:                 # Modalities to process with autopipeline
        image: CT
        mask: RTSTRUCT     
    ROI_STRATEGY: MERGE         # How to handle multiple ROI matches 
    ROI_MATCH_MAP:              # Matching map for ROIs in dataset (use if you only want to process some of the masks in a segmentation)
        KEY:ROI_NAME            # NOTE: there can be no spaces in KEY:ROI_NAME
</code></pre>
<h2 id="data-setup">Data Setup</h2>
<p>The following sections describe how to set up the data you wish to process with this pipeline following the BHKLab Data Management Protocol (DMP). This will ensure data remains separate from the project directory and accessible to other users.</p>
<h3 id="raw-data">Raw Data</h3>
<p>Set up a separate main data directory outside of the project directory. We'll call this <code>Datasets</code>.</p>
<p>In <code>Datasets</code>, set up a directory for the dataset you wish to process as follows:</p>
<pre><code class="language-bash">Datasets
|---- {DATASET_SOURCE}_{DATASET_NAME}
      |-- clinical
      |   `-- {Clinical Data File}.csv OR {Clinical Data File}.xlsx
      `-- images
          |-- {DATASET_NAME}
          |   |-- {PatientID}
          |   |   `-- {StudyUID}
          |   |       |-- {Image DICOM directory}
          |   |       |   |-- 1-01.dcm
          |   |       |   |-- ...
          |   |       |   |-- 1-N.dcm
          |   |       |-- {Mask DICOM directory}
          |   |       |   `-- 1-01.dcm
          |   |-- {PatientID}
          |   |-- ...
          |   `-- {PatientID}
          `-- annotations
              `-- {DATASET_NAME}
                  |-- DICOM-SR_annotation_file.dcm
                  |-- DICOM-SR_annotation_file.dcm
                  `-- DICOM-SR_annotation_file.dcm
</code></pre>
<p>Image directory structure may vary depending on the source. This example is based on the structure setup by TCIA when downloading with a manifest file.</p>
<p>!!! note "BHKLab DMP Setup"
    If using the BHKLab DMP, the <code>Datasets</code> directory will be structured with <code>rawdata/{DiseaseRegion}/{DATASET_SOURCE}_{DATASET_NAME}</code>. In the next step, you can create the symbolic link starting from <code>{DATASET_SOURCE}_{DATASET_NAME}</code>.</p>
<p>Once this data directory is setup, run the following in a terminal from the main directory of the project.</p>
<pre><code class="language-bash">ln -s /path/to/Datasets/{DATASET_SOURCE}_{DATASET_NAME} data/rawdata
</code></pre>
<p>This will create a symbolic link to your dataset in the <code>Datasets</code> directory. </p>
<p>You can confirm this worked by running:</p>
<pre><code class="language-bash">ls -l data/rawdata
</code></pre>
<p>and you should see,</p>
<pre><code class="language-bash">total 5
-rw-rw-r-- 1 bhkuser root 1395 Jun  4 15:21 README.md
lrwxrwxrwx 1 bhkuser root   80 Jun  4 15:46 {DATASET_SOURCE}_{DATASET_NAME} -&gt; /path/to/Datasets/{DATASET_SOURCE}_{DATASET_NAME}
</code></pre>
<p>Now, document the dataset you've added on the <a href="../data_sources/">Data Sources</a> page following the provided template.</p>
<hr />
<h3 id="processed-data">Processed Data</h3>
<p>If you wish to use the BHKLab DMP strategy, follow the process below.</p>
<p>Create a processed data directory for your dataset in the external <code>Datasets</code> directory as follows:</p>
<pre><code class="language-bash">mkdir /path/to/Datasets/procdata/{DiseaseRegion}/{DATASET_SOURCE}_{DATASET_NAME}
</code></pre>
<p><strong>Note</strong>: the Disease Region must match what is in the <code>rawdata</code> path to the dataset.</p>
<p>Now you can create a symbolic link to this directory in the project directory, like we did for the raw data.</p>
<pre><code class="language-bash">ln -s /path/to/Datasets/procdata/{DiseaseRegion}/{DATASET_SOURCE}_{DATASET_NAME} data/procdata
</code></pre>
<h3 id="results">Results</h3>
<p>TODO:: describe results directory setup</p>
<h2 id="running-your-analysis">Running Your Analysis</h2>
<h3 id="1-running-med-imagetools">1. Running Med-ImageTools</h3>
<p>TODO:: discuss using pixi tasks to run the analysis</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../data_sources/" class="btn btn-neutral float-right" title="Data Sources">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/bhklab/recist-vs-reality" class="fa fa-code-fork" style="color: #fcfcfc"> recist-vs-reality</a>
        </span>
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../data_sources/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
